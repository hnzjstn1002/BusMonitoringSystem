<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Galaxy of Life Questions</title>

<!-- Google Fonts (Poppins + Orbitron) -->
<link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700&family=Poppins:wght@300;400;600&display=swap" rel="stylesheet">

<style>
  :root{
    --bg1: #07071a;
    --bg2: #0b1030;
    --nebula1: rgba(138,43,226,0.13);
    --nebula2: rgba(0,255,255,0.06);
    --neon-cyan: rgba(64,224,208,0.95);
    --neon-pink: rgba(255,102,204,0.95);
    --neon-blue: rgba(102,153,255,0.95);
    --glass: rgba(255,255,255,0.03);
    --card-size: 80px;
  }

  html,body{
    height:100%;
    margin:0;
    font-family: "Poppins", system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
    background: radial-gradient(1200px 600px at 10% 10%, rgba(20,6,40,0.6), transparent),
                radial-gradient(900px 400px at 80% 80%, rgba(8,12,40,0.6), transparent),
                linear-gradient(180deg,var(--bg1),var(--bg2));
    color: #e9f0ff;
    -webkit-font-smoothing:antialiased;
    -moz-osx-font-smoothing:grayscale;
    overflow:hidden;
  }

  /* Nebula / moving background */
  .nebula {
    position:fixed;
    inset:0;
    pointer-events:none;
    z-index:0;
    background:
      radial-gradient(600px 300px at 20% 30%, var(--nebula1), transparent 20%),
      radial-gradient(500px 240px at 85% 60%, var(--nebula2), transparent 10%);
    mix-blend-mode: screen;
    animation: floatNebula 18s linear infinite;
    opacity:0.9;
  }
  @keyframes floatNebula{
    0%{transform:translateY(0) rotate(0);}
    50%{transform:translateY(-20px) rotate(2deg);}
    100%{transform:translateY(0) rotate(0);}
  }

  /* Stars layer (twinkling) */
  .stars, .stars::after {
    position:fixed;
    inset:0;
    background-image:
      radial-gradient(1px 1px at 10% 20%, #fff, rgba(255,255,255,0) 20%),
      radial-gradient(1px 1px at 30% 40%, #fff, rgba(255,255,255,0) 20%),
      radial-gradient(1px 1px at 50% 80%, #fff, rgba(255,255,255,0) 20%),
      radial-gradient(1px 1px at 70% 30%, #fff, rgba(255,255,255,0) 20%),
      radial-gradient(1px 1px at 85% 70%, #fff, rgba(255,255,255,0) 20%);
    z-index:0;
    opacity:0.65;
    animation: twinkle 6s ease-in-out infinite;
    pointer-events:none;
  }
  .stars::after{
    content:"";
    transform:scale(1.7);
    opacity:0.5;
    animation-duration:9s;
    animation-delay:2s;
  }

  @keyframes twinkle{
    0%{opacity:0.3}
    50%{opacity:0.9}
    100%{opacity:0.3}
  }

  /* Simple moving planet for decoration */
  .planet {
    position:fixed;
    right:5%;
    bottom:5%;
    width:160px;
    height:160px;
    border-radius:50%;
    background: radial-gradient(circle at 30% 30%, rgba(255,255,255,0.08), rgba(255,255,255,0.02)),
                conic-gradient(from 200deg at 50% 50%, rgba(255,255,255,0.04), rgba(0,0,0,0.02));
    box-shadow: 0 8px 40px rgba(0,0,0,0.6), 0 0 30px rgba(102,153,255,0.06) inset;
    z-index:0;
    opacity:0.9;
    transform: translateY(0);
    animation: bob 12s ease-in-out infinite;
    pointer-events:none;
  }
  @keyframes bob{ 0%{transform:translateY(0)} 50%{transform:translateY(-12px)} 100%{transform:translateY(0)} }

  /* App container */
  .app {
    position:relative;
    z-index:5;
    min-height:100vh;
    display:flex;
    align-items:center;
    justify-content:center;
    padding:40px 20px;
    box-sizing:border-box;
  }

  .stage {
    width:100%;
    max-width:1200px;
    height:80vh;
    min-height:540px;
    border-radius:18px;
    position:relative;
    overflow:hidden;
    backdrop-filter: blur(6px) saturate(1.1);
    box-shadow: 0 12px 60px rgba(2,6,23,0.6);
    border: 1px solid rgba(255,255,255,0.04);
    background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
    display:flex;
    flex-direction:column;
    align-items:center;
    justify-content:flex-start;
    padding:28px;
  }

  /* Header / Title */
  header {
    text-align:center;
    margin-bottom:8px;
    user-select:none;
  }

  h1.title {
    font-family: "Orbitron", "Poppins", sans-serif;
    font-weight:700;
    letter-spacing:1px;
    margin:0;
    font-size:clamp(20px,3.8vw,36px);
    color:white;
    text-shadow:
      0 0 10px rgba(102,153,255,0.55),
      0 0 22px rgba(255,102,204,0.08);
  }
  .subtitle {
    font-size:13px;
    color: #cfe7ff;
    opacity:0.85;
    margin-top:6px;
  }

  /* Controls */
  .controls {
    position:absolute;
    top:18px;
    right:22px;
    display:flex;
    gap:10px;
    z-index:6;
  }
  .btn {
    background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
    border:1px solid rgba(255,255,255,0.06);
    padding:8px 12px;
    border-radius:10px;
    color:#eaf6ff;
    font-weight:600;
    font-size:13px;
    cursor:pointer;
    backdrop-filter: blur(6px);
    transition: transform .14s ease, box-shadow .12s ease;
    box-shadow: 0 6px 18px rgba(2,8,32,0.5);
  }
  .btn:active{ transform:translateY(1px) scale(.995) }
  .btn.reset {
    text-shadow: 0 0 8px rgba(255,102,204,0.14);
  }

  /* Grid container for boxes (but we position randomly) */
  .playfield {
    position:relative;
    flex:1;
    width:100%;
    margin-top:16px;
    display:block;
  }

  /* Box / Card */
  .box {
    position:absolute;
    width:var(--card-size);
    height:var(--card-size);
    min-width:60px;
    min-height:60px;
    border-radius:12px;
    display:flex;
    align-items:center;
    justify-content:center;
    cursor:pointer;
    transition: transform .32s cubic-bezier(.2,.9,.2,1), box-shadow .25s ease;
    user-select:none;
    will-change:transform;
    box-shadow: 0 6px 18px rgba(2,6,30,0.5), 0 0 30px rgba(0,0,0,0.3) inset;
    background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
    border: 1px solid rgba(255,255,255,0.04);
    z-index:3;
    transform-origin:center;
  }
  .box:hover { transform: translateY(-8px) scale(1.03); }
  .box .core {
    width:72%;
    height:72%;
    border-radius:9px;
    background: linear-gradient(180deg, rgba(10,12,30,0.8), rgba(6,10,18,0.6));
    display:flex;
    align-items:center;
    justify-content:center;
    font-family: "Orbitron", sans-serif;
    font-size:14px;
    color:white;
    letter-spacing:0.8px;
    text-shadow: 0 0 6px rgba(102,153,255,0.12);
  }

  /* unopened mysterious state - small sparkle */
  .box .myst {
    width:10px;height:10px;border-radius:50%;
    background:linear-gradient(90deg,var(--neon-cyan), var(--neon-pink));
    box-shadow: 0 0 8px rgba(64,224,208,0.12), 0 0 18px rgba(255,102,204,0.06);
    animation: pulse 2s infinite;
    opacity:0.98;
  }
  @keyframes pulse{
    0%{transform:scale(.8); opacity:0.8}
    50%{transform:scale(1.3); opacity:1}
    100%{transform:scale(.8); opacity:0.85}
  }

  /* opened state */
  .box.opened {
    box-shadow: 0 12px 40px rgba(100,140,255,0.15), 0 0 40px rgba(102,153,255,0.06) inset;
    transform:scale(1.06) translateY(-10px);
    border: 1px solid rgba(102,153,255,0.25);
    animation: glowBox .9s ease;
  }
  @keyframes glowBox {
    0%{box-shadow: 0 0 0 rgba(102,153,255,0); transform:scale(.98)}
    60%{box-shadow: 0 18px 70px rgba(102,153,255,0.15)}
    100%{transform:scale(1.06)}
  }

  /* marker when opened (tiny check) */
  .box.opened .core::after{
    content:"";
    position:absolute;
    right:6px;
    top:6px;
    width:10px;height:10px;border-radius:50%;
    background:linear-gradient(90deg,var(--neon-pink),var(--neon-cyan));
    box-shadow:0 0 12px rgba(255,102,204,0.12);
  }

  /* Modal */
  .modal-backdrop {
    position:fixed;
    inset:0;
    display:flex;
    align-items:center;
    justify-content:center;
    background: linear-gradient(180deg, rgba(3,6,16,0.6), rgba(3,6,16,0.7));
    z-index:20;
    padding:20px;
    box-sizing:border-box;
  }
  .modal {
    width:100%;
    max-width:720px;
    border-radius:16px;
    padding:22px;
    background: linear-gradient(180deg, rgba(10,12,20,0.92), rgba(8,10,18,0.86));
    border:1px solid rgba(255,255,255,0.04);
    box-shadow: 0 18px 70px rgba(2,6,30,0.7);
    color:#e9f4ff;
    text-align:center;
    position:relative;
  }
  .modal h2 {
    margin:0 0 8px 0;
    font-family:"Orbitron", sans-serif;
    font-size:20px;
    letter-spacing:0.6px;
    text-shadow: 0 0 12px rgba(102,153,255,0.25);
  }
  .question {
    margin:10px 0 18px 0;
    font-size:clamp(16px,2.4vw,20px);
    line-height:1.4;
    padding: 12px 18px;
    border-radius:10px;
    background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
    box-shadow: inset 0 2px 8px rgba(0,0,0,0.35);
  }

  .modal .modal-actions{
    display:flex;
    gap:12px;
    justify-content:center;
    margin-top:8px;
  }
  .neon {
    font-family:"Orbitron", sans-serif;
    color:white;
    font-weight:700;
    text-transform:none;
    font-size:13px;
    padding:10px 16px;
    border-radius:10px;
    border: none;
    cursor:pointer;
    transition: transform .12s ease;
  }
  .neon:active{ transform:translateY(1px) }
  .neon.close {
    background: linear-gradient(90deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
    box-shadow: 0 10px 30px rgba(2,6,30,0.55);
    border:1px solid rgba(255,255,255,0.04);
  }
  .neon.next {
    background: linear-gradient(90deg, var(--neon-cyan), var(--neon-pink));
    box-shadow: 0 10px 32px rgba(64,224,208,0.06), 0 0 28px rgba(255,102,204,0.04);
    color: #021221;
    font-weight:700;
  }

  /* footer legend */
  .legend {
    font-size:13px;
    color:#bfe8ff;
    margin-top:12px;
    opacity:0.85;
    text-align:center;
  }

  /* responsive for mobile: limit positions to grid */
  @media (max-width:720px){
    .stage { height:90vh; padding:16px; }
    .box { width:64px; height:64px; --card-size:64px; }
  }

  /* When using random absolute positions we will ensure boxes don't run off-screen using JS */
</style>
</head>
<body>
  <div class="nebula" aria-hidden="true"></div>
  <div class="stars" aria-hidden="true"></div>
  <div class="planet" aria-hidden="true"></div>

  <div class="app" role="application" aria-label="Galaxy of Life Questions">
    <div class="stage" id="stage">
      <header>
        <h1 class="title">✨ Galaxy of Life Questions ✨</h1>
        <div class="subtitle">Click a mystery star-box to reveal a reflective life question</div>
      </header>

      <div class="controls">
        <button class="btn reset" id="restartBtn" title="Restart (reshuffle questions)">🔁 Restart</button>
        <button class="btn" id="muteBtn" title="Toggle sound">🔊 Sound: On</button>
      </div>

      <div class="playfield" id="playfield" aria-live="polite" aria-atomic="true">
        <!-- Boxes will be injected here by JS -->
      </div>

      <div class="legend">Explore at your pace — each box hides a question. Reflect, write, or share. 💫</div>
    </div>
  </div>

  <!-- Modal template (hidden until needed) -->
  <div id="modalBackdrop" class="modal-backdrop" style="display:none;" role="dialog" aria-modal="true" aria-labelledby="modalTitle">
    <div class="modal" role="document">
      <h2 id="modalTitle" class="neonTitle">Your Question</h2>
      <div id="questionText" class="question" tabindex="0"></div>
      <div class="modal-actions">
        <button class="neon close" id="closeBtn">Close</button>
        <button class="neon next" id="nextBtn">Next Question</button>
      </div>
    </div>
  </div>

<script>
/* ========== Data: 20 life questions ========== */
const QUESTIONS = [
  "What has been your biggest life struggle so far?",
  "How do you define success in your own words?",
  "When was the last time you truly felt proud of yourself?",
  "What’s something you wish people understood about you?",
  "What fear are you still trying to overcome?",
  "How do you cope with failure?",
  "What keeps you motivated during hard times?",
  "Have you ever felt lost? How did you find your way again?",
  "What life lesson took you the longest to learn?",
  "What’s one thing you’re currently healing from?",
  "What moment changed the way you see life?",
  "Who has had the biggest impact on your journey?",
  "If your life had a theme song, what would it be?",
  "What’s something you wish you could tell your younger self?",
  "How do you find peace amid chaos?",
  "What does happiness mean to you now?",
  "What failure turned into your biggest blessing?",
  "What makes you feel alive?",
  "What’s a dream you’re still chasing?",
  "How do you define strength?"
];

/* ========== App state ========== */
let assignments = []; // question assigned per box index
let opened = new Set(); // opened box indexes
let soundOn = true;

/* Utility: shuffle copy */
function shuffled(arr){
  const a = arr.slice();
  for(let i=a.length-1;i>0;i--){
    const j = Math.floor(Math.random()*(i+1));
    [a[i], a[j]] = [a[j], a[i]];
  }
  return a;
}

/* Create boxes and assign shuffled questions */
const playfield = document.getElementById('playfield');
const stage = document.getElementById('stage');

function createBoxes(count=20){
  playfield.innerHTML = '';
  opened.clear();

  // Prepare random positions in percent that avoid edges a bit
  const pos = [];
  for(let i=0;i<count;i++){
    // generate a position; we will later adjust collisions
    pos.push({x: 6 + Math.random() * 88, y: 8 + Math.random() * 78});
  }

  // crude collision avoidance: push overlapped boxes away
  for(let iter=0; iter<6; iter++){
    for(let i=0;i<pos.length;i++){
      for(let j=i+1;j<pos.length;j++){
        const dx = pos[j].x - pos[i].x;
        const dy = pos[j].y - pos[i].y;
        const dist = Math.hypot(dx, dy);
        const minDist = 12; // percent units
        if(dist < minDist){
          const angle = Math.atan2(dy, dx) || Math.random()*Math.PI*2;
          const shift = (minDist - dist)/2 + 1;
          pos[j].x += Math.cos(angle)*shift;
          pos[j].y += Math.sin(angle)*shift;
          pos[i].x -= Math.cos(angle)*shift;
          pos[i].y -= Math.sin(angle)*shift;
          // clamp
          pos[j].x = Math.min(92, Math.max(6, pos[j].x));
          pos[j].y = Math.min(92, Math.max(6, pos[j].y));
          pos[i].x = Math.min(92, Math.max(6, pos[i].x));
          pos[i].y = Math.min(6, Math.max(6, pos[i].y));
        }
      }
    }
  }

  // assign questions randomly (one per box)
  const pool = shuffled(QUESTIONS).slice(0, count);
  assignments = pool.slice();

  for(let i=0;i<count;i++){
    const b = document.createElement('div');
    b.className = 'box';
    b.setAttribute('role','button');
    b.setAttribute('tabindex',0);
    b.setAttribute('aria-label','Mystery question box');
    b.dataset.index = i;

    // position
    b.style.left = pos[i].x + '%';
    b.style.top  = pos[i].y + '%';
    // slight random transform to vary rotation
    const rot = (Math.random()*20-10).toFixed(2);
    b.style.transform = `rotate(${rot}deg)`;

    // inner core
    const core = document.createElement('div');
    core.className = 'core';
    const myst = document.createElement('span');
    myst.className = 'myst';
    core.appendChild(myst);
    b.appendChild(core);

    // click handler
    b.addEventListener('click', onBoxClick);
    b.addEventListener('keydown', (e)=>{
      if(e.key === 'Enter' || e.key === ' '){
        e.preventDefault();
        b.click();
      }
    });
    playfield.appendChild(b);
  }
}

/* Modal handling */
const modalBackdrop = document.getElementById('modalBackdrop');
const questionText = document.getElementById('questionText');
const closeBtn = document.getElementById('closeBtn');
const nextBtn = document.getElementById('nextBtn');

function openModalWithText(text){
  questionText.textContent = text;
  modalBackdrop.style.display = 'flex';
  questionText.focus();
  playChime();
}

function closeModal(){
  modalBackdrop.style.display = 'none';
  // return focus to stage
  stage.focus();
}

/* Box click */

function onBoxClick(e){
  const box = e.currentTarget;
  const idx = Number(box.dataset.index);
  if(opened.has(idx)) {
    // already opened - maybe play a lighter sound
    playSoft();
    flashBox(box);
    return;
  }
  // mark open
  opened.add(idx);
  box.classList.add('opened');
  // show assigned question
  const q = assignments[idx] || "A quiet question awaits your heart.";
  openModalWithText(q);
}

/* animations for already opened */
function flashBox(box){
  box.style.transition = 'transform .12s ease';
  box.style.transform += ' scale(1.02)';
  setTimeout(()=>{ box.style.transform = box.style.transform.replace(' scale(1.02)',''); }, 180);
}

/* Reset / Restart */
const restartBtn = document.getElementById('restartBtn');
restartBtn.addEventListener('click', ()=>{
  assignments = shuffled(QUESTIONS).slice(0,20);
  createBoxes(20);
  // small feedback
  playSoft();
});

/* Modal buttons */
closeBtn.addEventListener('click', ()=> closeModal());
nextBtn.addEventListener('click', ()=> {
  closeModal();
  playSoft();
});

/* Close ESC */
document.addEventListener('keydown', (e)=>{
  if(e.key === 'Escape' && modalBackdrop.style.display === 'flex'){
    closeModal();
  }
});

/* Sound using WebAudio - gentle chime + soft click */
const AudioCtx = window.AudioContext || window.webkitAudioContext;
let audioCtx = null;
function ensureAudio(){
  if(!audioCtx) audioCtx = new AudioCtx();
}
function playChime(){
  if(!soundOn) return;
  ensureAudio();
  const o = audioCtx.createOscillator();
  const g = audioCtx.createGain();
  o.type = 'sine';
  const now = audioCtx.currentTime;
  o.frequency.setValueAtTime(880, now);
  o.frequency.exponentialRampToValueAtTime(440, now+0.28);
  g.gain.setValueAtTime(0.0001, now);
  g.gain.exponentialRampToValueAtTime(0.14, now+0.02);
  g.gain.exponentialRampToValueAtTime(0.001, now+0.8);
  o.connect(g); g.connect(audioCtx.destination);
  o.start(now);
  o.stop(now+0.85);
}
function playSoft(){
  if(!soundOn) return;
  ensureAudio();
  const o = audioCtx.createOscillator();
  const g = audioCtx.createGain();
  o.type = 'triangle';
  const now = audioCtx.currentTime;
  o.frequency.setValueAtTime(660, now);
  o.frequency.exponentialRampToValueAtTime(540, now+0.12);
  g.gain.setValueAtTime(0.0001, now);
  g.gain.exponentialRampToValueAtTime(0.08, now+0.005);
  g.gain.exponentialRampToValueAtTime(0.001, now+0.45);
  o.connect(g); g.connect(audioCtx.destination);
  o.start(now);
  o.stop(now+0.5);
}

/* Mute toggle */
const muteBtn = document.getElementById('muteBtn');
muteBtn.addEventListener('click', ()=>{
  soundOn = !soundOn;
  muteBtn.textContent = soundOn? '🔊 Sound: On' : '🔈 Sound: Off';
});

/* Initialize */
(function init(){
  assignments = shuffled(QUESTIONS).slice(0,20);
  createBoxes(20);

  // subtle gentle tilt animations per box to simulate 'floating'
  const boxes = () => document.querySelectorAll('.box');
  let i = 0;
  setInterval(()=>{
    const nlist = boxes();
    nlist.forEach((b, idx)=>{
      const shift = Math.sin((Date.now()/1800) + idx)*2.2;
      b.style.transform = b.style.transform.replace(/translateY\(-?\d+px\)/, '') + ` translateY(${shift}px)`;
    });
  }, 200);

  // Small hint: spacebar to shuffle
  document.addEventListener('keydown', (e)=>{
    if(e.key === ' ' && document.activeElement.tagName !== 'INPUT' && document.activeElement.tagName !== 'TEXTAREA'){
      e.preventDefault();
    }
  });
})();

</script>
</body>
</html>
